@using Hara.UI.Shared.Ionic.Models
@inherits BaseIonicPresentableComponent<object, Hara.UI.Shared.Ionic.Models.OverlayEventDetail<Hara.UI.Shared.Ionic.Models.IonicComponentDismissPayloadData>>
<div style="display: none" @ref="modalContainer">
    <div @ref="modalContent">@ChildContent</div>
</div>

@code {

    [Parameter(CaptureUnmatchedValues = true)]
    public Dictionary<string, object> InputAttributes { get; set; }

    [Parameter]
    public RenderFragment ChildContent { get; set; }

    ElementReference modalContent;
    ElementReference modalContainer;

    protected override async Task CreateElement()
    {
        await JsRuntime.InvokeVoidAsync("removeremove", modalContent, modalContainer);
        var data = new Dictionary<string, object>()
        {
            {"component", modalContent}
        };
        await JsRuntime.InvokeVoidAsync("createElement", "ion-modal", Id, InputAttributes, data);
        await JsRuntime.InvokeVoidAsync("registerBlazorCustomHandler", Id, "ionModalDidDismiss", ThisRef, nameof(HandleDismissed));
        await JsRuntime.InvokeVoidAsync("registerBlazorCustomHandler", Id, "ionModalDidPresent", ThisRef, nameof(HandlePresented));
    }
}